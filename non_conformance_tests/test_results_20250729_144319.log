HTTP/3 Non-Conformance Test Results
==================================================
Test Run: 2025-07-29 14:47:01
Total Tests: 48
Passed: 48
Failed: 0


============================================================
TEST CASE #1: test_priority_update_first_frame.py
============================================================
Status: PASSED
Execution Time: 3.25s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #1
======================================================================
ğŸ“‹ Test: PRIORITY_UPDATE frame before SETTINGS frame
ğŸš« Violation: RFC 9114 Section 6.2.1 - SETTINGS must be first frame on control stream
ğŸ“š RFC Section: RFC 9114 Section 6.2.1
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Creating control stream
ğŸ“ Sending PRIORITY_UPDATE as FIRST frame
ğŸš« PROTOCOL VIOLATION: SETTINGS frame should be first!
âœ… PRIORITY_UPDATE sent on stream 14
ğŸ“ Creating QPACK streams
ğŸ“ Sending HTTP request
âœ… HTTP request sent on stream 0
ğŸ“ Sending SETTINGS frame (late)
ğŸš« STILL NON-CONFORMANT: Should have been first frame
âœ… SETTINGS frame sent (but violates 'first frame' requirement)

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #1 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Priority Update Sent
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Request Sent
   âœ… PASS Settings Sent Late

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ PRIORITY_UPDATE was sent as first frame (protocol violation)
   â€¢ SETTINGS frame was sent later (still non-conformant)
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 7/7 steps passed in 3.03s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #3: test_multiple_requests_same_stream.py
============================================================
Status: PASSED
Execution Time: 3.66s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #3
======================================================================
ğŸ“‹ Test: Multiple requests on same stream
ğŸš« Violation: RFC 9114 Section 4.1 - Client must send only single request per stream
ğŸ“š RFC Section: RFC 9114 Section 4.1
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending first request (conformant)
âœ… First HEADERS frame sent on stream 0
   â””â”€ Method: GET, Path: /first-request (conformant)
ğŸ“ Sending second request on SAME stream
ğŸš« PROTOCOL VIOLATION: Multiple requests on same stream!
ğŸš« RFC 9114 Section 4.1: Client MUST send only single request per stream
âœ… Second HEADERS frame sent on stream 0
   â””â”€ Method: POST, Path: /second-request (VIOLATION!)
ğŸ“ Sending POST data for second request
âš ï¸  POST data failed: DATA frame is not allowed in this state (may be expected due to connection state)

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #3 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS First Request Sent
   âœ… PASS Second Request Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ POST data failed: DATA frame is not allowed in this state
   â€¢ First request sent normally (conformant)
   â€¢ Second request sent on same stream (protocol violation)
   â€¢ RFC 9114 Section 4.1 violation demonstrated
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 6/6 steps passed in 3.03s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #5: test_data_frame_before_headers.py
============================================================
Status: PASSED
Execution Time: 3.24s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #5
======================================================================
ğŸ“‹ Test: DATA frame before HEADERS frame
ğŸš« Violation: Invalid frame sequence - DATA before HEADERS triggers H3_FRAME_UNEXPECTED
ğŸ“š RFC Section: HTTP/3 Frame Sequencing
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending DATA frame WITHOUT HEADERS first
ğŸš« PROTOCOL VIOLATION: DATA frame before HEADERS is invalid!
ğŸš« Expected error: H3_FRAME_UNEXPECTED (0x105)
âŒ Failed to send DATA frame: DATA frame is not allowed in this state
   â””â”€ This may indicate the violation was caught early

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #5 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Data Frame Sent First

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ DATA frame sending failed: DATA frame is not allowed in this state
   â€¢ DATA frame sent before any HEADERS frame (protocol violation)
   â€¢ Invalid frame sequence should trigger H3_FRAME_UNEXPECTED
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 5/5 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #7: test_data_frame_after_trailing_headers.py
============================================================
Status: PASSED
Execution Time: 3.24s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #7
======================================================================
ğŸ“‹ Test: DATA frame after trailing HEADERS frame
ğŸš« Violation: Invalid frame sequence - DATA after trailing HEADERS triggers H3_FRAME_UNEXPECTED
ğŸ“š RFC Section: HTTP/3 Frame Sequencing Rules
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending initial HEADERS frame
âœ… Initial HEADERS frame sent on stream 0
   â””â”€ Headers: 6 header fields
ğŸ“ Sending trailing HEADERS frame (closes stream)
âœ… Trailing HEADERS frame sent with end_stream=True
   â””â”€ This should close the request stream
   â””â”€ No more frames should be sent on this stream
ğŸ“ Sending DATA frame AFTER trailing HEADERS
ğŸš« PROTOCOL VIOLATION: DATA frame after trailing HEADERS is invalid!
ğŸš« Expected error: H3_FRAME_UNEXPECTED (0x105)
âŒ Failed to send DATA frame: DATA frame is not allowed in this state
   â””â”€ This may indicate the violation was caught early

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #7 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Initial Headers Sent
   âœ… PASS Trailing Headers Sent
   âœ… PASS Data After Trailing Headers Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ DATA frame sending failed: DATA frame is not allowed in this state
   â€¢ DATA frame sent after trailing HEADERS with end_stream=True (protocol violation)
   â€¢ Invalid frame sequence should trigger H3_FRAME_UNEXPECTED
   â€¢ Stream should have been closed by trailing HEADERS frame
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 7/7 steps passed in 3.03s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #10: test_transfer_encoding_header.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #10
======================================================================
ğŸ“‹ Test: Transfer-Encoding header in HTTP/3 request
ğŸš« Violation: Transfer-Encoding header MUST NOT be used in HTTP/3
ğŸ“š RFC Section: HTTP/3 Header Field Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with Transfer-Encoding: chunked
ğŸš« PROTOCOL VIOLATION: Transfer-Encoding header MUST NOT be used in HTTP/3!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with Transfer-Encoding sent on stream 0
   â””â”€ Headers: 8 header fields
   â””â”€ This violates HTTP/3 transfer coding restrictions!
ğŸ“ Sending DATA frame with request body
âœ… DATA frame sent on stream 0
   â””â”€ Payload: 71 bytes

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #10 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Transfer Encoding Headers Sent
   âœ… PASS Request Body Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Request sent with Transfer-Encoding: chunked header (protocol violation)
   â€¢ Transfer codings are not defined for HTTP/3
   â€¢ Transfer-Encoding header field MUST NOT be used by client
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 6/6 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #12: test_uppercase_header_names.py
============================================================
Status: PASSED
Execution Time: 3.24s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #12
======================================================================
ğŸ“‹ Test: Uppercase header field names
ğŸš« Violation: Header field names MUST be lowercase in HTTP/3
ğŸ“š RFC Section: HTTP/3 Header Field Encoding
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with uppercase header field names
ğŸš« PROTOCOL VIOLATION: Header field names MUST be lowercase in HTTP/3!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with uppercase field names sent on stream 0
   â””â”€ Headers: 10 header fields
   â””â”€ Uppercase headers: Content-Type, User-Agent, Accept, etc.
   â””â”€ This violates HTTP/3 lowercase header requirement!
ğŸ“ Sending DATA frame with request body
âœ… DATA frame sent on stream 0
   â””â”€ Payload: 65 bytes

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #12 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Uppercase Headers Sent
   âœ… PASS Request Body Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Request sent with uppercase header field names (protocol violation)
   â€¢ Header field names MUST be lowercase prior to encoding in HTTP/3
   â€¢ Uppercase headers: Content-Type, User-Agent, Accept, X-Test-Case, Authorization, Cache-Control
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 6/6 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #14: test_connection_header_fields.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #14
======================================================================
ğŸ“‹ Test: Connection-specific header fields
ğŸš« Violation: Connection-specific fields MUST NOT be used in HTTP/3
ğŸ“š RFC Section: HTTP/3 Header Field Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with connection-specific header fields
ğŸš« PROTOCOL VIOLATION: Connection-specific fields MUST NOT be used in HTTP/3!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with connection-specific fields sent on stream 0
   â””â”€ Headers: 11 header fields
   â””â”€ Forbidden headers: Connection, Upgrade, Proxy-Connection, Keep-Alive, TE
   â””â”€ This violates HTTP/3 connection-specific field restrictions!
ğŸ“ Sending DATA frame with request body
âœ… DATA frame sent on stream 0
   â””â”€ Payload: 74 bytes

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #14 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Connection Headers Sent
   âœ… PASS Request Body Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Request sent with connection-specific header fields (protocol violation)
   â€¢ HTTP/3 field section MUST NOT contain connection-specific fields
   â€¢ Forbidden headers: Connection, Upgrade, Proxy-Connection, Keep-Alive, TE
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 6/6 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #16: test_undefined_pseudo_headers.py
============================================================
Status: PASSED
Execution Time: 3.23s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #16
======================================================================
ğŸ“‹ Test: Undefined pseudo-header fields
ğŸš« Violation: Undefined pseudo-headers MUST NOT be generated by client
ğŸ“š RFC Section: HTTP/3 Pseudo-Header Field Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with undefined pseudo-header fields
ğŸš« PROTOCOL VIOLATION: Undefined pseudo-headers MUST NOT be generated!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with undefined pseudo-headers sent on stream 0
   â””â”€ Headers: 12 header fields
   â””â”€ Undefined pseudo-headers: :foo, :custom-header, :version, :protocol, :status, :encoding
   â””â”€ This violates HTTP/3 pseudo-header field restrictions!
ğŸ“ Sending DATA frame with request body
âœ… DATA frame sent on stream 0
   â””â”€ Payload: 67 bytes

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #16 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Undefined Pseudo Headers Sent
   âœ… PASS Request Body Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Request sent with undefined pseudo-header fields (protocol violation)
   â€¢ Client MUST NOT generate pseudo-headers other than :method, :path, :scheme, :authority
   â€¢ Undefined pseudo-headers: :foo, :custom-header, :version, :protocol, :status, :encoding
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 6/6 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #18: test_request_pseudoheaders_in_response.py
============================================================
Status: PASSED
Execution Time: 8.23s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #18
======================================================================
ğŸ“‹ Test: Request pseudo-headers in server response
ğŸš« Violation: Server MUST NOT include request pseudo-headers in responses
ğŸ“š RFC Section: HTTP/3 Response Pseudo-Header Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending request that might trigger pseudo-header echoing
ğŸ” Testing if server incorrectly includes request pseudo-headers in response
ğŸš« Server violation: Including :method, :path in response headers
âœ… Echo test HEADERS frame sent on stream 0
   â””â”€ Headers: 10 header fields
   â””â”€ Testing server response header validation
ğŸ“ Sending request body
âœ… Request body sent on stream 0
   â””â”€ Payload: 36 bytes
ğŸ“ Monitoring for server response behavior
ğŸ” Checking if server incorrectly includes request pseudo-headers
   Expected: Response should only contain :status pseudo-header
   Violation: Response containing :method, :path, :scheme, :authority

ğŸ“ Extended response observation (5.0s)
ğŸ” Note: This test requires manual response analysis
   â””â”€ Check server logs for response header violations
   â””â”€ Verify responses don't contain request pseudo-headers
   â””â”€ Valid response pseudo-headers: only :status

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #18 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Echo Test Headers Sent
   âœ… PASS Request Body Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed
   â€¢ Testing for server-side violation: request pseudo-headers in response
   â€¢ Compliant response should only contain :status pseudo-header
   â€¢ Violation: Response containing :method, :path, :scheme, :authority
   â€¢ Monitor server logs/responses for improper pseudo-header echoing

ğŸ“Š Summary: 6/6 steps passed in 8.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #19: test_response_pseudoheaders_in_request.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #19
======================================================================
ğŸ“‹ Test: Response pseudo-headers in client request
ğŸš« Violation: Response pseudo-headers MUST NOT appear in requests
ğŸ“š RFC Section: HTTP/3 Request Pseudo-Header Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with response pseudo-header fields
ğŸš« PROTOCOL VIOLATION: Response pseudo-headers MUST NOT appear in requests!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with response pseudo-headers sent on stream 0
   â””â”€ Headers: 8 header fields
   â””â”€ Forbidden response pseudo-header: :status
   â””â”€ This violates HTTP/3 request pseudo-header restrictions!
ğŸ“ Sending DATA frame with request body
âœ… DATA frame sent on stream 0
   â””â”€ Payload: 77 bytes

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #19 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Response Pseudo Headers Sent
   âœ… PASS Request Body Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Request sent with response pseudo-header :status (protocol violation)
   â€¢ Response pseudo-headers MUST NOT appear in requests
   â€¢ Valid request pseudo-headers: :method, :path, :scheme, :authority only
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 6/6 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #20: test_pseudoheaders_in_trailers.py
============================================================
Status: PASSED
Execution Time: 3.23s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #20
======================================================================
ğŸ“‹ Test: Pseudo-headers in trailing HEADERS frame
ğŸš« Violation: Pseudo-headers MUST NOT appear in trailer sections
ğŸ“š RFC Section: HTTP/3 Trailer Field Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending initial HEADERS frame
âœ… Initial HEADERS frame sent on stream 0
   â””â”€ Headers: 8 header fields
ğŸ“ Sending DATA frame with request body
âœ… DATA frame sent on stream 0
   â””â”€ Payload: 72 bytes
ğŸ“ Sending trailing HEADERS frame with pseudo-headers
ğŸš« PROTOCOL VIOLATION: Pseudo-headers MUST NOT appear in trailer sections!
ğŸš« Expected error: Connection termination or header rejection
âœ… Trailing HEADERS frame with pseudo-headers sent on stream 0
   â””â”€ Trailers: 7 header fields
   â””â”€ Forbidden pseudo-headers: :path, :method, :status, :scheme
   â””â”€ This violates HTTP/3 trailer field restrictions!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #20 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Initial Headers Sent
   âœ… PASS Request Body Sent
   âœ… PASS Pseudo Trailers Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Trailing HEADERS frame sent with pseudo-headers (protocol violation)
   â€¢ Pseudo-headers MUST NOT appear in trailer sections
   â€¢ Forbidden pseudo-headers in trailers: :path, :method, :status, :scheme
   â€¢ Valid trailers should only contain regular header fields
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 7/7 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #22: test_incorrect_header_ordering.py
============================================================
Status: PASSED
Execution Time: 3.23s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #22
======================================================================
ğŸ“‹ Test: Incorrect header ordering
ğŸš« Violation: Pseudo-headers MUST appear before regular headers in requests
ğŸ“š RFC Section: HTTP/3 Header Field Ordering Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with incorrect header ordering
ğŸš« PROTOCOL VIOLATION: Regular headers appear before pseudo-headers!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with incorrect ordering sent on stream 0
   â””â”€ Headers: 11 header fields
   â””â”€ Order: Regular headers first, then pseudo-headers
   â””â”€ This violates HTTP/3 header ordering requirements!
ğŸ“ Sending DATA frame with request body
âŒ Failed to send DATA frame: DATA frame is not allowed in this state

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #22 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Incorrect Header Ordering Sent
   âŒ FAIL Request Body Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ DATA frame sending failed: DATA frame is not allowed in this state
   â€¢ HEADERS frame sent with incorrect ordering (protocol violation)
   â€¢ Regular headers appeared before pseudo-headers
   â€¢ Pseudo-headers MUST appear before regular headers in requests
   â€¢ Correct order: :method, :path, :scheme, :authority, then regular headers
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 5/6 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #24: test_authority_with_userinfo.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #24
======================================================================
ğŸ“‹ Test: :authority with userinfo component
ğŸš« Violation: :authority MUST NOT include userinfo for http/https URIs
ğŸ“š RFC Section: HTTP/3 Authority Pseudo-Header Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with :authority containing userinfo
ğŸš« PROTOCOL VIOLATION: :authority MUST NOT include userinfo for http/https!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with userinfo in :authority sent on stream 0
   â””â”€ Headers: 7 header fields
   â””â”€ :authority contains: testuser:testpass@test-server:443
   â””â”€ This violates HTTP/3 authority field restrictions!
ğŸ“ Sending second request with different userinfo format
âœ… Second HEADERS frame with username-only userinfo sent on stream 4
   â””â”€ :authority contains: admin@test-server
ğŸ“ Sending DATA frames with request bodies
âœ… First DATA frame sent on stream 0
âœ… Second DATA frame sent on stream 4

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #24 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Authority With Userinfo Sent
   âœ… PASS Authority With Username Only Sent
   âœ… PASS Request Body 1 Sent
   âœ… PASS Request Body 2 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Requests sent with userinfo in :authority pseudo-header (protocol violation)
   â€¢ :authority MUST NOT include deprecated userinfo for http/https URIs
   â€¢ Tested formats: user:password@host and user@host
   â€¢ Valid :authority should only contain host[:port]
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 8/8 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #25: test_empty_path_pseudoheader.py
============================================================
Status: PASSED
Execution Time: 3.21s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #25
======================================================================
ğŸ“‹ Test: Empty :path pseudo-header field
ğŸš« Violation: :path MUST NOT be empty for http/https URIs
ğŸ“š RFC Section: HTTP/3 Path Pseudo-Header Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with empty :path pseudo-header
ğŸš« PROTOCOL VIOLATION: :path MUST NOT be empty for http/https URIs!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with empty :path sent on stream 0
   â””â”€ Headers: 7 header fields
   â””â”€ :path value: '' (empty string)
   â””â”€ This violates HTTP/3 path field requirements!
ğŸ“ Sending second request without :path pseudo-header
âœ… Second HEADERS frame without :path sent on stream 4
   â””â”€ :path pseudo-header completely missing
ğŸ“ Sending DATA frames with request bodies
âœ… First DATA frame sent on stream 0
âœ… Second DATA frame sent on stream 4

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #25 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Empty Path Sent
   âœ… PASS Missing Path Sent
   âœ… PASS Request Body 1 Sent
   âœ… PASS Request Body 2 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Requests sent with empty/missing :path pseudo-header (protocol violation)
   â€¢ :path MUST NOT be empty for http/https URIs
   â€¢ URIs without path component MUST use :path value of '/'
   â€¢ Tested both empty string and missing :path pseudo-header
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 8/8 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #26: test_missing_method_pseudoheader.py
============================================================
Status: PASSED
Execution Time: 3.32s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #26
======================================================================
ğŸ“‹ Test: Missing :method pseudo-header field
ğŸš« Violation: :method pseudo-header MUST be present in all HTTP/3 requests
ğŸ“š RFC Section: HTTP/3 Request Pseudo-Header Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame without :method pseudo-header
ğŸš« PROTOCOL VIOLATION: :method pseudo-header MUST be present in HTTP/3 requests!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame without :method sent on stream 0
   â””â”€ Headers: 6 header fields
   â””â”€ Missing required :method pseudo-header
   â””â”€ This violates HTTP/3 request requirements!
ğŸ“ Sending second request with empty :method pseudo-header
âœ… Second HEADERS frame with empty :method sent on stream 4
   â””â”€ :method value: '' (empty string)
ğŸ“ Sending third request with duplicate :method pseudo-headers
âœ… Third HEADERS frame with duplicate :method sent on stream 8
   â””â”€ Duplicate :method values: GET and POST
ğŸ“ Sending DATA frames with request bodies
âœ… First DATA frame sent on stream 0
âœ… Second DATA frame sent on stream 4
âœ… Third DATA frame sent on stream 8

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #26 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Missing Method Headers Sent
   âœ… PASS Empty Method Headers Sent
   âœ… PASS Duplicate Method Headers Sent
   âœ… PASS Request Body 1 Sent
   âœ… PASS Request Body 2 Sent
   âœ… PASS Request Body 3 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Requests sent with missing/invalid :method pseudo-header (protocol violation)
   â€¢ All HTTP/3 requests MUST include exactly one :method pseudo-header
   â€¢ Tested missing :method, empty :method, and duplicate :method
   â€¢ Exception: CONNECT requests may omit :method (not tested here)
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 10/10 steps passed in 3.03s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #27: test_missing_scheme_pseudoheader.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #27
======================================================================
ğŸ“‹ Test: Missing :scheme pseudo-header field
ğŸš« Violation: :scheme pseudo-header MUST be present in all HTTP/3 requests
ğŸ“š RFC Section: HTTP/3 Request Pseudo-Header Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame without :scheme pseudo-header
ğŸš« PROTOCOL VIOLATION: :scheme pseudo-header MUST be present in HTTP/3 requests!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame without :scheme sent on stream 0
   â””â”€ Headers: 6 header fields
   â””â”€ Missing required :scheme pseudo-header
   â””â”€ This violates HTTP/3 request requirements!
ğŸ“ Sending second request with empty :scheme pseudo-header
âœ… Second HEADERS frame with empty :scheme sent on stream 4
   â””â”€ :scheme value: '' (empty string)
ğŸ“ Sending third request with duplicate :scheme pseudo-headers
âœ… Third HEADERS frame with duplicate :scheme sent on stream 8
   â””â”€ Duplicate :scheme values: https and http
ğŸ“ Sending fourth request with invalid :scheme pseudo-header
âœ… Fourth HEADERS frame with invalid :scheme sent on stream 12
   â””â”€ Invalid :scheme value: ftp (should be http or https)
ğŸ“ Sending DATA frames with request bodies
âœ… First DATA frame sent on stream 0
âœ… Second DATA frame sent on stream 4
âœ… Third DATA frame sent on stream 8
âœ… Fourth DATA frame sent on stream 12

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #27 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Missing Scheme Headers Sent
   âœ… PASS Empty Scheme Headers Sent
   âœ… PASS Duplicate Scheme Headers Sent
   âœ… PASS Invalid Scheme Headers Sent
   âœ… PASS Request Body 1 Sent
   âœ… PASS Request Body 2 Sent
   âœ… PASS Request Body 3 Sent
   âœ… PASS Request Body 4 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Requests sent with missing/invalid :scheme pseudo-header (protocol violation)
   â€¢ All HTTP/3 requests MUST include exactly one :scheme pseudo-header
   â€¢ Tested missing :scheme, empty :scheme, duplicate :scheme, and invalid :scheme
   â€¢ Valid schemes for HTTP/3: http, https
   â€¢ Exception: CONNECT requests may omit :scheme (not tested here)
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 12/12 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #28: test_missing_path_pseudoheader.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #28
======================================================================
ğŸ“‹ Test: Missing :path pseudo-header field
ğŸš« Violation: :path pseudo-header MUST be present in all HTTP/3 requests
ğŸ“š RFC Section: HTTP/3 Request Pseudo-Header Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame without :path pseudo-header
ğŸš« PROTOCOL VIOLATION: :path pseudo-header MUST be present in HTTP/3 requests!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame without :path sent on stream 0
   â””â”€ Headers: 6 header fields
   â””â”€ Missing required :path pseudo-header
   â””â”€ This violates HTTP/3 request requirements!
ğŸ“ Sending second request with duplicate :path pseudo-headers
âœ… Second HEADERS frame with duplicate :path sent on stream 4
   â””â”€ Duplicate :path values: /test-duplicate-path-1 and /test-duplicate-path-2
ğŸ“ Sending third request with malformed :path pseudo-header
âœ… Third HEADERS frame with malformed :path sent on stream 8
   â””â”€ Malformed :path value: '/test path with spaces' (contains unencoded spaces)
ğŸ“ Sending fourth request with :path containing control characters
âœ… Fourth HEADERS frame with control characters in :path sent on stream 12
   â””â”€ :path contains control characters: \x00\x01\x02
ğŸ“ Sending DATA frames with request bodies
âœ… First DATA frame sent on stream 0
âœ… Second DATA frame sent on stream 4
âœ… Third DATA frame sent on stream 8
âœ… Fourth DATA frame sent on stream 12

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #28 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Missing Path Headers Sent
   âœ… PASS Duplicate Path Headers Sent
   âœ… PASS Malformed Path Headers Sent
   âœ… PASS Control Char Path Headers Sent
   âœ… PASS Request Body 1 Sent
   âœ… PASS Request Body 2 Sent
   âœ… PASS Request Body 3 Sent
   âœ… PASS Request Body 4 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Requests sent with missing/invalid :path pseudo-header (protocol violation)
   â€¢ All HTTP/3 requests MUST include exactly one :path pseudo-header
   â€¢ Tested missing :path, duplicate :path, malformed :path, and :path with control chars
   â€¢ Valid :path must be properly encoded URI path component
   â€¢ Exception: CONNECT requests may omit :path (not tested here)
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 12/12 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #29: test_missing_authority_and_host.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #29
======================================================================
ğŸ“‹ Test: Missing :authority and Host headers
ğŸš« Violation: HTTPS requests MUST contain either :authority or Host header
ğŸ“š RFC Section: HTTP/3 Authority Component Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HTTPS request without :authority or Host header
ğŸš« PROTOCOL VIOLATION: HTTPS requests MUST contain either :authority or Host!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame without :authority or Host sent on stream 0
   â””â”€ Headers: 6 header fields
   â””â”€ Missing both :authority pseudo-header and Host header
   â””â”€ This violates HTTP/3 authority requirements for HTTPS!
ğŸ“ Sending second request with HTTP scheme without authority
âœ… Second HEADERS frame (HTTP) without authority sent on stream 4
   â””â”€ HTTP scheme also requires authority component
ğŸ“ Sending third request with empty :authority pseudo-header
âœ… Third HEADERS frame with empty :authority sent on stream 8
   â””â”€ :authority value: '' (empty string)
ğŸ“ Sending fourth request with empty Host header
âœ… Fourth HEADERS frame with empty Host header sent on stream 12
   â””â”€ Host header value: '' (empty string)
ğŸ“ Sending DATA frames with request bodies
âœ… First DATA frame sent on stream 0
âœ… Second DATA frame sent on stream 4
âœ… Third DATA frame sent on stream 8
âœ… Fourth DATA frame sent on stream 12

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #29 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Missing Authority And Host Sent
   âœ… PASS Http Missing Authority Sent
   âœ… PASS Empty Authority Sent
   âœ… PASS Empty Host Sent
   âœ… PASS Request Body 1 Sent
   âœ… PASS Request Body 2 Sent
   âœ… PASS Request Body 3 Sent
   âœ… PASS Request Body 4 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Requests sent without required authority component (protocol violation)
   â€¢ HTTP/HTTPS schemes MUST contain either :authority or Host header
   â€¢ Tested missing both, empty :authority, and empty Host header
   â€¢ Authority component identifies the target server for the request
   â€¢ Valid authority: :authority pseudo-header OR Host header (but not both empty)
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 12/12 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #30: test_empty_authority_pseudoheader.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #30
======================================================================
ğŸ“‹ Test: Empty :authority pseudo-header field
ğŸš« Violation: :authority pseudo-header MUST NOT be empty when present
ğŸ“š RFC Section: HTTP/3 Authority Pseudo-Header Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with empty :authority pseudo-header
ğŸš« PROTOCOL VIOLATION: :authority pseudo-header MUST NOT be empty when present!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with empty :authority sent on stream 0
   â””â”€ Headers: 7 header fields
   â””â”€ :authority value: '' (empty string)
   â””â”€ This violates HTTP/3 authority requirements!
ğŸ“ Sending second request with whitespace-only :authority
âœ… Second HEADERS frame with whitespace :authority sent on stream 4
   â””â”€ :authority value: '   ' (whitespace only)
ğŸ“ Sending third request with duplicate :authority pseudo-headers
âœ… Third HEADERS frame with duplicate :authority sent on stream 8
   â””â”€ First :authority: '' (empty), Second :authority: 'test-server'
ğŸ“ Sending fourth request with invalid characters in :authority
âœ… Fourth HEADERS frame with invalid :authority chars sent on stream 12
   â””â”€ :authority contains control characters: \x00 and \x01
ğŸ“ Sending fifth request with malformed :authority (invalid port)
âœ… Fifth HEADERS frame with malformed :authority port sent on stream 16
   â””â”€ :authority port: 99999 (exceeds valid range)
ğŸ“ Sending DATA frames with request bodies
âœ… First DATA frame sent on stream 0
âœ… Second DATA frame sent on stream 4
âœ… Third DATA frame sent on stream 8
âœ… Fourth DATA frame sent on stream 12
âœ… Fifth DATA frame sent on stream 16

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #30 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Empty Authority Sent
   âœ… PASS Whitespace Authority Sent
   âœ… PASS Duplicate Authority Sent
   âœ… PASS Invalid Authority Chars Sent
   âœ… PASS Malformed Authority Port Sent
   âœ… PASS Request Body 1 Sent
   âœ… PASS Request Body 2 Sent
   âœ… PASS Request Body 3 Sent
   âœ… PASS Request Body 4 Sent
   âœ… PASS Request Body 5 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Requests sent with invalid :authority pseudo-header values (protocol violation)
   â€¢ :authority pseudo-header MUST NOT be empty when present
   â€¢ Tested empty, whitespace, duplicate, invalid chars, and malformed port
   â€¢ Valid :authority format: host[:port] with proper encoding
   â€¢ Empty :authority is worse than missing :authority entirely
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 14/14 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #31: test_empty_host_header.py
============================================================
Status: PASSED
Execution Time: 3.20s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #31
======================================================================
ğŸ“‹ Test: Empty Host header field
ğŸš« Violation: Host header MUST NOT be empty when present
ğŸ“š RFC Section: HTTP/3 Host Header Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with empty Host header
ğŸš« PROTOCOL VIOLATION: Host header MUST NOT be empty when present!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with empty Host header sent on stream 0
   â””â”€ Headers: 7 header fields
   â””â”€ Host header value: '' (empty string)
   â””â”€ This violates HTTP/3 Host header requirements!
ğŸ“ Sending second request with whitespace-only Host header
âœ… Second HEADERS frame with whitespace Host header sent on stream 4
   â””â”€ Host header value: '   ' (whitespace only)
ğŸ“ Sending third request with duplicate Host headers
âœ… Third HEADERS frame with duplicate Host headers sent on stream 8
   â””â”€ First Host: '' (empty), Second Host: 'test-server'
ğŸ“ Sending fourth request with invalid characters in Host header
âœ… Fourth HEADERS frame with invalid Host header chars sent on stream 12
   â””â”€ Host header contains control characters: \x00 and \x01
ğŸ“ Sending fifth request with conflicting :authority and Host headers
âœ… Fifth HEADERS frame with conflicting authority/host sent on stream 16
   â””â”€ :authority: 'authority-server', Host: '' (empty)
ğŸ“ Sending sixth request with malformed Host header (invalid port)
âœ… Sixth HEADERS frame with malformed Host header port sent on stream 20
   â””â”€ Host header port: 99999 (exceeds valid range)
ğŸ“ Sending DATA frames with request bodies
âœ… First DATA frame sent on stream 0
âœ… Second DATA frame sent on stream 4
âœ… Third DATA frame sent on stream 8
âœ… Fourth DATA frame sent on stream 12
âœ… Fifth DATA frame sent on stream 16
âœ… Sixth DATA frame sent on stream 20

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #31 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Empty Host Sent
   âœ… PASS Whitespace Host Sent
   âœ… PASS Duplicate Host Sent
   âœ… PASS Invalid Host Chars Sent
   âœ… PASS Conflicting Authority Host Sent
   âœ… PASS Malformed Host Port Sent
   âœ… PASS Request Body 1 Sent
   âœ… PASS Request Body 2 Sent
   âœ… PASS Request Body 3 Sent
   âœ… PASS Request Body 4 Sent
   âœ… PASS Request Body 5 Sent
   âœ… PASS Request Body 6 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Requests sent with invalid Host header values (protocol violation)
   â€¢ Host header MUST NOT be empty when present
   â€¢ Tested empty, whitespace, duplicate, invalid chars, conflicting, and malformed port
   â€¢ Valid Host header format: host[:port] with proper encoding
   â€¢ Host header serves same purpose as :authority pseudo-header
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 16/16 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #32: test_conflicting_authority_host.py
============================================================
Status: PASSED
Execution Time: 3.23s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #32
======================================================================
ğŸ“‹ Test: Conflicting :authority and Host headers
ğŸš« Violation: Host and :authority MUST contain the same value when both present
ğŸ“š RFC Section: HTTP/3 Authority Component Consistency Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with conflicting :authority and Host headers
ğŸš« PROTOCOL VIOLATION: Host and :authority MUST contain the same value!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with conflicting authority/host sent on stream 0
   â””â”€ Headers: 8 header fields
   â””â”€ :authority: 'authority-server.com'
   â””â”€ Host: 'host-server.com'
   â””â”€ This violates HTTP/3 authority consistency requirements!
ğŸ“ Sending second request with port mismatches
âœ… Second HEADERS frame with port mismatch sent on stream 4
   â””â”€ :authority: 'test-server.com:443'
   â””â”€ Host: 'test-server.com:8443'
ğŸ“ Sending third request with case differences
âœ… Third HEADERS frame with case mismatch sent on stream 8
   â””â”€ :authority: 'test-server.com'
   â””â”€ Host: 'TEST-SERVER.COM'
ğŸ“ Sending fourth request with subtle differences (trailing dot)
âœ… Fourth HEADERS frame with subtle differences sent on stream 12
   â””â”€ :authority: 'test-server.com'
   â””â”€ Host: 'test-server.com.'
ğŸ“ Sending fifth request with IPv6 vs hostname mismatch
âœ… Fifth HEADERS frame with IPv6/hostname mismatch sent on stream 16
   â””â”€ :authority: '[::1]:443'
   â””â”€ Host: 'localhost:443'
ğŸ“ Sending sixth request with implicit vs explicit port
âœ… Sixth HEADERS frame with implicit/explicit port sent on stream 20
   â””â”€ :authority: 'test-server.com' (implicit port 443)
   â””â”€ Host: 'test-server.com:443' (explicit port 443)
ğŸ“ Sending DATA frames with request bodies
âœ… First DATA frame sent on stream 0
âœ… Second DATA frame sent on stream 4
âœ… Third DATA frame sent on stream 8
âœ… Fourth DATA frame sent on stream 12
âœ… Fifth DATA frame sent on stream 16
âœ… Sixth DATA frame sent on stream 20

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #32 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Conflicting Authority Host Sent
   âœ… PASS Port Mismatch Sent
   âœ… PASS Case Mismatch Sent
   âœ… PASS Subtle Differences Sent
   âœ… PASS Ipv6 Hostname Mismatch Sent
   âœ… PASS Implicit Explicit Port Sent
   âœ… PASS Request Body 1 Sent
   âœ… PASS Request Body 2 Sent
   âœ… PASS Request Body 3 Sent
   âœ… PASS Request Body 4 Sent
   âœ… PASS Request Body 5 Sent
   âœ… PASS Request Body 6 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Requests sent with conflicting Host and :authority values (protocol violation)
   â€¢ Host and :authority MUST contain the same value when both present
   â€¢ Tested hostname, port, case, subtle, IPv6/hostname, and implicit/explicit port mismatches
   â€¢ Authority consistency is critical for HTTP/3 request routing
   â€¢ Implementations should normalize and compare authority values consistently
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 16/16 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #33: test_authority_with_non_authority_scheme.py
============================================================
Status: PASSED
Execution Time: 3.24s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #33
======================================================================
ğŸ“‹ Test: Authority with non-authority scheme
ğŸš« Violation: Non-authority schemes MUST NOT contain :authority pseudo-header
ğŸ“š RFC Section: HTTP/3 Scheme-Specific Authority Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with mailto scheme and :authority
ğŸš« PROTOCOL VIOLATION: Non-authority schemes MUST NOT contain :authority!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with mailto + :authority sent on stream 0
   â””â”€ Headers: 7 header fields
   â””â”€ :scheme: 'mailto' (no authority component)
   â””â”€ :authority: 'mail-server.com' (forbidden)
   â””â”€ This violates HTTP/3 scheme-authority requirements!
ğŸ“ Sending second request with file scheme and :authority
âœ… Second HEADERS frame with file + :authority sent on stream 4
   â””â”€ :scheme: 'file' (no authority component)
   â””â”€ :authority: 'localhost' (forbidden)
ğŸ“ Sending third request with data scheme and :authority
âœ… Third HEADERS frame with data + :authority sent on stream 8
   â””â”€ :scheme: 'data' (no authority component)
   â””â”€ :authority: 'data-server.com' (forbidden)
ğŸ“ Sending fourth request with tel scheme and :authority
âœ… Fourth HEADERS frame with tel + :authority sent on stream 12
   â””â”€ :scheme: 'tel' (no authority component)
   â””â”€ :authority: 'telecom-provider.com' (forbidden)
ğŸ“ Sending fifth request with urn scheme and :authority
âœ… Fifth HEADERS frame with urn + :authority sent on stream 16
   â””â”€ :scheme: 'urn' (no authority component)
   â””â”€ :authority: 'urn-resolver.org' (forbidden)
ğŸ“ Sending sixth request with mailto scheme and empty :authority
âœ… Sixth HEADERS frame with mailto + empty :authority sent on stream 20
   â””â”€ :scheme: 'mailto' (no authority component)
   â””â”€ :authority: '' (empty and forbidden)
ğŸ“ Sending DATA frames with request bodies
âœ… First DATA frame sent on stream 0
âœ… Second DATA frame sent on stream 4
âœ… Third DATA frame sent on stream 8
âœ… Fourth DATA frame sent on stream 12
âœ… Fifth DATA frame sent on stream 16
âœ… Sixth DATA frame sent on stream 20

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #33 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Mailto With Authority Sent
   âœ… PASS File With Authority Sent
   âœ… PASS Data With Authority Sent
   âœ… PASS Tel With Authority Sent
   âœ… PASS Urn With Authority Sent
   âœ… PASS Empty Authority Non Authority Scheme Sent
   âœ… PASS Request Body 1 Sent
   âœ… PASS Request Body 2 Sent
   âœ… PASS Request Body 3 Sent
   âœ… PASS Request Body 4 Sent
   âœ… PASS Request Body 5 Sent
   âœ… PASS Request Body 6 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Requests sent with :authority for non-authority schemes (protocol violation)
   â€¢ Non-authority schemes MUST NOT contain :authority pseudo-header
   â€¢ Tested schemes: mailto, file, data, tel, urn (all non-authority)
   â€¢ Authority schemes (http/https) require authority; non-authority schemes forbid it
   â€¢ Scheme-authority consistency is critical for proper URI semantics
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 16/16 steps passed in 3.03s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #34: test_host_header_with_non_authority_scheme.py
============================================================
Status: PASSED
Execution Time: 3.25s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #34
======================================================================
ğŸ“‹ Test: Host header with non-authority scheme
ğŸš« Violation: Non-authority schemes MUST NOT contain Host header field
ğŸ“š RFC Section: HTTP/3 Scheme-Specific Host Header Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with mailto scheme and Host header
ğŸš« PROTOCOL VIOLATION: Non-authority schemes MUST NOT contain Host header!
ğŸš« Expected error: Connection termination or header rejection
âœ… HEADERS frame with mailto + Host sent on stream 0
   â””â”€ Headers: 7 header fields
   â””â”€ :scheme: 'mailto' (no authority component)
   â””â”€ Host: 'mail-server.com' (forbidden)
   â””â”€ This violates HTTP/3 scheme-host requirements!
ğŸ“ Sending second request with file scheme and Host header
âœ… Second HEADERS frame with file + Host sent on stream 4
   â””â”€ :scheme: 'file' (no authority component)
   â””â”€ Host: 'file-server.local' (forbidden)
ğŸ“ Sending third request with data scheme and Host header
âœ… Third HEADERS frame with data + Host sent on stream 8
   â””â”€ :scheme: 'data' (no authority component)
   â””â”€ Host: 'data-processor.com' (forbidden)
ğŸ“ Sending fourth request with tel scheme and Host header
âœ… Fourth HEADERS frame with tel + Host sent on stream 12
   â””â”€ :scheme: 'tel' (no authority component)
   â””â”€ Host: 'telecom-gateway.net' (forbidden)
ğŸ“ Sending fifth request with urn scheme and Host header
âœ… Fifth HEADERS frame with urn + Host sent on stream 16
   â””â”€ :scheme: 'urn' (no authority component)
   â””â”€ Host: 'urn-resolver.org' (forbidden)
ğŸ“ Sending sixth request with mailto scheme and empty Host header
âœ… Sixth HEADERS frame with mailto + empty Host sent on stream 20
   â””â”€ :scheme: 'mailto' (no authority component)
   â””â”€ Host: '' (empty and forbidden)
ğŸ“ Sending seventh request with file scheme and duplicate Host headers
âœ… Seventh HEADERS frame with file + duplicate Host sent on stream 24
   â””â”€ :scheme: 'file' (no authority component)
   â””â”€ Host: 'fileserver1.local' + 'fileserver2.local' (duplicate and forbidden)
ğŸ“ Sending eighth request with data scheme, Host header, and :authority
âœ… Eighth HEADERS frame with data + Host + :authority sent on stream 28
   â””â”€ :scheme: 'data' (no authority component)
   â””â”€ :authority: 'data-authority.com' (forbidden)
   â””â”€ Host: 'data-host.com' (forbidden)
ğŸ“ Sending DATA frames with request bodies
âœ… First DATA frame sent on stream 0
âœ… Second DATA frame sent on stream 4
âœ… Third DATA frame sent on stream 8
âœ… Fourth DATA frame sent on stream 12
âœ… Fifth DATA frame sent on stream 16
âœ… Sixth DATA frame sent on stream 20
âœ… Seventh DATA frame sent on stream 24
âœ… Eighth DATA frame sent on stream 28

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #34 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Mailto With Host Sent
   âœ… PASS File With Host Sent
   âœ… PASS Data With Host Sent
   âœ… PASS Tel With Host Sent
   âœ… PASS Urn With Host Sent
   âœ… PASS Empty Host Non Authority Scheme Sent
   âœ… PASS Duplicate Host Non Authority Scheme Sent
   âœ… PASS Both Host Authority Non Authority Scheme Sent
   âœ… PASS Request Body 1 Sent
   âœ… PASS Request Body 2 Sent
   âœ… PASS Request Body 3 Sent
   âœ… PASS Request Body 4 Sent
   âœ… PASS Request Body 5 Sent
   âœ… PASS Request Body 6 Sent
   âœ… PASS Request Body 7 Sent
   âœ… PASS Request Body 8 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Requests sent with Host header for non-authority schemes (protocol violation)
   â€¢ Non-authority schemes MUST NOT contain Host header field
   â€¢ Tested schemes: mailto, file, data, tel, urn (all non-authority)
   â€¢ Host header is companion to :authority; both forbidden for non-authority schemes
   â€¢ Scheme-host consistency is critical for proper HTTP/3 semantics
   â€¢ Tested variations: normal Host, empty Host, duplicate Host, Host+:authority
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 20/20 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #36: test_connect_request_with_scheme.py
============================================================
Status: PASSED
Execution Time: 3.26s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #36
======================================================================
ğŸ“‹ Test: CONNECT request with :scheme pseudo-header
ğŸš« Violation: CONNECT requests MUST NOT include :scheme pseudo-header
ğŸ“š RFC Section: HTTP/3 CONNECT Method Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending CONNECT request with :scheme pseudo-header
ğŸš« PROTOCOL VIOLATION: CONNECT requests MUST NOT include :scheme!
ğŸš« Expected error: Connection termination or header rejection
âœ… CONNECT request with :scheme sent on stream 0
   â””â”€ Headers: 5 header fields
   â””â”€ :method: 'CONNECT'
   â””â”€ :authority: 'example.com:443' (required)
   â””â”€ :scheme: 'https' (forbidden)
   â””â”€ This violates HTTP/3 CONNECT method requirements!
ğŸ“ Sending second CONNECT request with http scheme
âœ… Second CONNECT request with http scheme sent on stream 4
   â””â”€ :scheme: 'http' (forbidden)
ğŸ“ Sending third CONNECT request with ws scheme
âœ… Third CONNECT request with ws scheme sent on stream 8
   â””â”€ :scheme: 'ws' (forbidden)
   â””â”€ :protocol: 'websocket' (valid for extended CONNECT)
ğŸ“ Sending fourth CONNECT request with invalid scheme
âœ… Fourth CONNECT request with ssh scheme sent on stream 12
   â””â”€ :scheme: 'ssh' (forbidden and invalid)
ğŸ“ Sending fifth CONNECT request with empty scheme
âœ… Fifth CONNECT request with empty scheme sent on stream 16
   â””â”€ :scheme: '' (empty and forbidden)
ğŸ“ Sending sixth CONNECT request with duplicate schemes
âœ… Sixth CONNECT request with duplicate schemes sent on stream 20
   â””â”€ :scheme: 'https' + 'http' (duplicate and forbidden)
ğŸ“ Sending seventh CONNECT request with :scheme and :path
âœ… Seventh CONNECT request with :scheme and :path sent on stream 24
   â””â”€ :scheme: 'https' (forbidden)
   â””â”€ :path: '/tunnel' (also forbidden in CONNECT)
ğŸ“ Sending DATA frames for tunnel establishment
âœ… First tunnel DATA frame sent on stream 0
âœ… Second tunnel DATA frame sent on stream 4
âœ… Third tunnel DATA frame sent on stream 8
âœ… Fourth tunnel DATA frame sent on stream 12
âœ… Fifth tunnel DATA frame sent on stream 16
âœ… Sixth tunnel DATA frame sent on stream 20
âœ… Seventh tunnel DATA frame sent on stream 24

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #36 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Connect With Scheme Sent
   âœ… PASS Connect With Http Scheme Sent
   âœ… PASS Connect With Ws Scheme Sent
   âœ… PASS Connect With Ssh Scheme Sent
   âœ… PASS Connect With Empty Scheme Sent
   âœ… PASS Connect With Duplicate Schemes Sent
   âœ… PASS Connect With Scheme And Path Sent
   âœ… PASS Tunnel Data 1 Sent
   âœ… PASS Tunnel Data 2 Sent
   âœ… PASS Tunnel Data 3 Sent
   âœ… PASS Tunnel Data 4 Sent
   âœ… PASS Tunnel Data 5 Sent
   âœ… PASS Tunnel Data 6 Sent
   âœ… PASS Tunnel Data 7 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ CONNECT requests sent with forbidden :scheme pseudo-header (protocol violation)
   â€¢ CONNECT method MUST NOT include :scheme pseudo-header field
   â€¢ CONNECT is for tunneling; :scheme is for resource identification
   â€¢ Tested variations: https, http, ws, ssh, empty, duplicate schemes
   â€¢ Also tested combination with :path (separate CONNECT violation)
   â€¢ CONNECT requests should only have :method and :authority pseudo-headers
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 18/18 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #37: test_connect_request_with_path.py
============================================================
Status: PASSED
Execution Time: 3.23s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #37
======================================================================
ğŸ“‹ Test: CONNECT request with :path pseudo-header
ğŸš« Violation: CONNECT requests MUST NOT include :path pseudo-header
ğŸ“š RFC Section: HTTP/3 CONNECT Method Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending CONNECT request with :path pseudo-header
ğŸš« PROTOCOL VIOLATION: CONNECT requests MUST NOT include :path!
ğŸš« Expected error: Connection termination or header rejection
âœ… CONNECT request with :path sent on stream 0
   â””â”€ Headers: 5 header fields
   â””â”€ :method: 'CONNECT'
   â””â”€ :authority: 'example.com:443' (required)
   â””â”€ :path: '/tunnel' (forbidden)
   â””â”€ This violates HTTP/3 CONNECT method requirements!
ğŸ“ Sending second CONNECT request with root path
âœ… Second CONNECT request with root path sent on stream 4
   â””â”€ :path: '/' (forbidden)
ğŸ“ Sending third CONNECT request with query parameters
âœ… Third CONNECT request with query path sent on stream 8
   â””â”€ :path: '/connect?target=backend&port=5432' (forbidden)
ğŸ“ Sending fourth CONNECT request with fragment
âœ… Fourth CONNECT request with fragment path sent on stream 12
   â””â”€ :path: '/ws#connection' (forbidden)
ğŸ“ Sending fifth CONNECT request with empty path
âœ… Fifth CONNECT request with empty path sent on stream 16
   â””â”€ :path: '' (empty and forbidden)
ğŸ“ Sending sixth CONNECT request with duplicate paths
âœ… Sixth CONNECT request with duplicate paths sent on stream 20
   â””â”€ :path: '/tunnel1' + '/tunnel2' (duplicate and forbidden)
ğŸ“ Sending seventh CONNECT request with absolute URI path
âœ… Seventh CONNECT request with absolute URI path sent on stream 24
   â””â”€ :path: 'https://target.example.com:443/resource' (forbidden)
ğŸ“ Sending eighth CONNECT request with :path and :scheme
âœ… Eighth CONNECT request with :path and :scheme sent on stream 28
   â””â”€ :path: '/secure-tunnel' (forbidden)
   â””â”€ :scheme: 'https' (also forbidden in CONNECT)
ğŸ“ Sending DATA frames for tunnel establishment
âœ… First tunnel DATA frame sent on stream 0
âœ… Second tunnel DATA frame sent on stream 4
âœ… Third tunnel DATA frame sent on stream 8
âœ… Fourth tunnel DATA frame sent on stream 12
âœ… Fifth tunnel DATA frame sent on stream 16
âœ… Sixth tunnel DATA frame sent on stream 20
âœ… Seventh tunnel DATA frame sent on stream 24
âœ… Eighth tunnel DATA frame sent on stream 28

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #37 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Connect With Path Sent
   âœ… PASS Connect With Root Path Sent
   âœ… PASS Connect With Query Path Sent
   âœ… PASS Connect With Fragment Path Sent
   âœ… PASS Connect With Empty Path Sent
   âœ… PASS Connect With Duplicate Paths Sent
   âœ… PASS Connect With Absolute Path Sent
   âœ… PASS Connect With Path And Scheme Sent
   âœ… PASS Tunnel Data 1 Sent
   âœ… PASS Tunnel Data 2 Sent
   âœ… PASS Tunnel Data 3 Sent
   âœ… PASS Tunnel Data 4 Sent
   âœ… PASS Tunnel Data 5 Sent
   âœ… PASS Tunnel Data 6 Sent
   âœ… PASS Tunnel Data 7 Sent
   âœ… PASS Tunnel Data 8 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ CONNECT requests sent with forbidden :path pseudo-header (protocol violation)
   â€¢ CONNECT method MUST NOT include :path pseudo-header field
   â€¢ CONNECT is for tunneling; :path is for resource identification
   â€¢ Tested variations: normal path, root, query, fragment, empty, duplicate, absolute URI
   â€¢ Also tested combination with :scheme (separate CONNECT violation)
   â€¢ CONNECT requests should only have :method and :authority pseudo-headers
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 20/20 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #38: test_connect_request_without_authority.py
============================================================
Status: PASSED
Execution Time: 3.21s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #38
======================================================================
ğŸ“‹ Test: CONNECT request without :authority pseudo-header
ğŸš« Violation: CONNECT requests MUST include :authority pseudo-header
ğŸ“š RFC Section: HTTP/3 CONNECT Method Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending CONNECT request without :authority pseudo-header
ğŸš« PROTOCOL VIOLATION: CONNECT requests MUST include :authority!
ğŸš« Expected error: Connection termination or header rejection
âœ… CONNECT request without :authority sent on stream 0
   â””â”€ Headers: 3 header fields
   â””â”€ :method: 'CONNECT'
   â””â”€ :authority: MISSING (required)
   â””â”€ This violates HTTP/3 CONNECT method requirements!
ğŸ“ Sending second CONNECT request with empty :authority
âœ… Second CONNECT request with empty :authority sent on stream 4
   â””â”€ :authority: '' (empty, effectively missing)
ğŸ“ Sending third CONNECT request with forbidden headers but no :authority
âœ… Third CONNECT request with forbidden headers but no :authority sent on stream 8
   â””â”€ :scheme: 'https' (forbidden)
   â””â”€ :path: '/tunnel' (forbidden)
   â””â”€ :authority: MISSING (required)
ğŸ“ Sending fourth CONNECT request with Host header but no :authority
âœ… Fourth CONNECT request with Host but no :authority sent on stream 12
   â””â”€ Host: 'example.com:443' (not equivalent to :authority for CONNECT)
   â””â”€ :authority: MISSING (required)
ğŸ“ Sending fifth CONNECT request with whitespace-only :authority
âœ… Fifth CONNECT request with whitespace :authority sent on stream 16
   â””â”€ :authority: '   ' (whitespace-only, effectively missing)
ğŸ“ Sending sixth CONNECT request with malformed :authority
âœ… Sixth CONNECT request with malformed :authority sent on stream 20
   â””â”€ :authority: 'not-a-valid-host:port' (malformed)
ğŸ“ Sending seventh CONNECT request with only :method
âœ… Seventh CONNECT request with only :method sent on stream 24
   â””â”€ Headers: Only :method, no :authority
ğŸ“ Sending eighth CONNECT request with invalid :authority format
âœ… Eighth CONNECT request with invalid :authority format sent on stream 28
   â””â”€ :authority: 'just-hostname-no-port' (missing port)
ğŸ“ Sending DATA frames for tunnel establishment
âœ… First tunnel DATA frame sent on stream 0
âœ… Second tunnel DATA frame sent on stream 4
âœ… Third tunnel DATA frame sent on stream 8
âœ… Fourth tunnel DATA frame sent on stream 12
âœ… Fifth tunnel DATA frame sent on stream 16
âœ… Sixth tunnel DATA frame sent on stream 20
âœ… Seventh tunnel DATA frame sent on stream 24
âœ… Eighth tunnel DATA frame sent on stream 28

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #38 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Connect Without Authority Sent
   âœ… PASS Connect With Empty Authority Sent
   âœ… PASS Connect Forbidden Headers No Authority Sent
   âœ… PASS Connect Host Header No Authority Sent
   âœ… PASS Connect Whitespace Authority Sent
   âœ… PASS Connect Malformed Authority Sent
   âœ… PASS Connect Only Method Sent
   âœ… PASS Connect Invalid Authority Format Sent
   âœ… PASS Tunnel Data 1 Sent
   âœ… PASS Tunnel Data 2 Sent
   âœ… PASS Tunnel Data 3 Sent
   âœ… PASS Tunnel Data 4 Sent
   âœ… PASS Tunnel Data 5 Sent
   âœ… PASS Tunnel Data 6 Sent
   âœ… PASS Tunnel Data 7 Sent
   âœ… PASS Tunnel Data 8 Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ CONNECT requests sent without required :authority pseudo-header (protocol violation)
   â€¢ CONNECT method MUST include :authority pseudo-header field
   â€¢ Authority specifies tunnel destination; without it, tunnel cannot be established
   â€¢ Tested variations: missing, empty, whitespace, malformed, invalid format
   â€¢ Host header cannot substitute for :authority in CONNECT requests
   â€¢ CONNECT requires exactly :method and :authority pseudo-headers
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 20/20 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #39: test_push_stream_without_max_push_id.py
============================================================
Status: PASSED
Execution Time: 5.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #39
======================================================================
ğŸ“‹ Test: Push stream without MAX_PUSH_ID frame
ğŸš« Violation: Server MUST NOT push when client hasn't sent MAX_PUSH_ID
ğŸ“š RFC Section: HTTP/3 Server Push Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Deliberately NOT sending MAX_PUSH_ID frame
ğŸš« CLIENT BEHAVIOR: No MAX_PUSH_ID sent - server push should be disabled
ğŸš« Expected: Server MUST NOT initiate any push streams
âœ… MAX_PUSH_ID frame deliberately omitted
   â””â”€ Server push should be disabled
   â””â”€ Any server push attempt would violate HTTP/3 specification
ğŸ“ Sending requests that typically trigger server push
âœ… HTML request sent on stream 0
   â””â”€ Path: /index.html
   â””â”€ This might typically trigger server push for CSS/JS/images
   â””â”€ Server MUST NOT push since no MAX_PUSH_ID was sent
ğŸ“ Sending second request for resource-heavy page
âœ… Resource-heavy request sent on stream 4
   â””â”€ Path: /dashboard
   â””â”€ Typically has many sub-resources
ğŸ“ Sending third request with explicit push hints
âœ… Push hint request sent on stream 8
   â””â”€ Path: /app
   â””â”€ Contains headers that might encourage push
ğŸ“ Sending fourth request simulating SPA
âœ… SPA request sent on stream 12
   â””â”€ Path: /spa
   â””â”€ SPAs often benefit from aggressive server push
ğŸ“ Sending fifth request with Link preload headers
âœ… Preload request sent on stream 16
   â””â”€ Path: /preload-test
   â””â”€ Contains explicit preload hints
ğŸ“ Sending sixth request with cache optimization headers
âœ… Cache optimization request sent on stream 20
   â””â”€ Path: /optimized
   â””â”€ Headers suggest cache optimization via push
ğŸ“ Observing server behavior for push stream attempts
â±ï¸  Waiting for potential server response and push attempts...
âœ… Observation period completed
   â””â”€ Any server push attempts during this period would be violations
   â””â”€ Server should have processed requests without pushing resources
ğŸ“ Sending final request to confirm connection state
âœ… Final request sent on stream 24
   â””â”€ Connection should still be active
   â””â”€ No push streams should have been initiated

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #39 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Max Push Id Deliberately Omitted
   âœ… PASS Request Stream Created
   âœ… PASS Html Request Sent
   âœ… PASS Resource Heavy Request Sent
   âœ… PASS Push Hint Request Sent
   âœ… PASS Spa Request Sent
   âœ… PASS Preload Request Sent
   âœ… PASS Cache Opt Request Sent
   âœ… PASS Observation Period Completed
   âœ… PASS Final Request Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed
   â€¢ Client deliberately did NOT send MAX_PUSH_ID frame
   â€¢ Multiple requests sent that typically trigger server push
   â€¢ Server MUST NOT initiate push streams without MAX_PUSH_ID
   â€¢ Any push stream attempts would violate HTTP/3 specification
   â€¢ Expected behavior: Server processes requests normally, no push
   â€¢ Violation check: Monitor for H3_ID_ERROR if server attempts push
   â€¢ Test validates server compliance with MAX_PUSH_ID requirement

ğŸ“Š Summary: 13/13 steps passed in 5.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #40: test_push_id_exceeds_max_push_id.py
============================================================
Status: PASSED
Execution Time: 6.21s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #40
======================================================================
ğŸ“‹ Test: Push ID exceeds MAX_PUSH_ID limit
ğŸš« Violation: Server MUST NOT use push IDs greater than client's MAX_PUSH_ID
ğŸ“š RFC Section: HTTP/3 Server Push ID Management
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Sending MAX_PUSH_ID frame with limit = 3
ğŸ”’ CLIENT LIMIT: Server can only use push IDs 0, 1, 2, 3
ğŸš« Expected: Server MUST NOT use push IDs 4, 5, 6, etc.
âœ… MAX_PUSH_ID frame sent with limit = 3
   â””â”€ Server can use push IDs: 0, 1, 2, 3
   â””â”€ Push IDs 4+ would violate the limit
ğŸ“ Sending multiple requests to encourage server push
âœ… Request 1 sent on stream 0 (/main.html)
   â””â”€ This might trigger push for: CSS, JS, images, fonts
âœ… Request 2 sent on stream 4 (/dashboard.html)
   â””â”€ This might trigger push for many resources (10+ expected)
âœ… Request 3 sent on stream 8 (/app.html)
   â””â”€ This might trigger push for multiple modules
âœ… Request 4 sent on stream 12 (/gallery.html)
   â””â”€ This might trigger push for 20+ media resources
âœ… Request 5 sent on stream 16 (/product.html)
   â””â”€ This might trigger push for product and related resources
âœ… Request 6 sent on stream 20 (/docs.html)
   â””â”€ This might trigger push for documentation assets
ğŸ“ Sending additional requests to maximize push attempts
âœ… Request 7 sent on stream 24 (/page7.html)
âœ… Request 8 sent on stream 28 (/page8.html)
âœ… Request 9 sent on stream 32 (/page9.html)
âœ… Request 10 sent on stream 36 (/page10.html)
âœ… Request 11 sent on stream 40 (/page11.html)
ğŸ“ Observing server push behavior
â±ï¸  Monitoring for push IDs > 3 (violation)
âœ…  Valid push IDs: 0, 1, 2, 3
ğŸš«  Invalid push IDs: 4, 5, 6, 7, 8, ...
âœ… Observation period completed
   â””â”€ Any push attempts with ID > 3 would be violations
   â””â”€ Server should have respected MAX_PUSH_ID limit
ğŸ“ Sending final status request
âœ… Final status request sent on stream 44
   â””â”€ Connection should still be active
   â””â”€ No H3_ID_ERROR should have occurred

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #40 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Max Push Id Sent
   âœ… PASS Request Stream Created
   âœ… PASS Request 1 Sent
   âœ… PASS Request 2 Sent
   âœ… PASS Request 3 Sent
   âœ… PASS Request 4 Sent
   âœ… PASS Request 5 Sent
   âœ… PASS Request 6 Sent
   âœ… PASS Request 7 Sent
   âœ… PASS Request 8 Sent
   âœ… PASS Request 9 Sent
   âœ… PASS Request 10 Sent
   âœ… PASS Request 11 Sent
   âœ… PASS Observation Period Completed
   âœ… PASS Final Status Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed
   â€¢ Client sent MAX_PUSH_ID = 3 (allows push IDs 0-3)
   â€¢ Multiple resource-intensive requests sent to trigger push
   â€¢ Server MUST NOT use push IDs > 3
   â€¢ Push ID violations should trigger H3_ID_ERROR
   â€¢ Expected: Server respects push ID limit or doesn't push
   â€¢ Violation: Server uses push IDs 4, 5, 6, etc.
   â€¢ Test validates server compliance with MAX_PUSH_ID limits

ğŸ“Š Summary: 18/18 steps passed in 6.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #41: test_goaway_increasing_identifiers.py
============================================================
Status: PASSED
Execution Time: 6.21s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #41
======================================================================
ğŸ“‹ Test: GOAWAY frames with increasing identifiers
ğŸš« Violation: GOAWAY frame identifiers MUST NOT increase across multiple frames
ğŸ“š RFC Section: HTTP/3 GOAWAY Frame Requirements
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating initial requests to establish stream IDs
âœ… Request 1 sent on stream 0
âœ… Request 2 sent on stream 4
âœ… Request 3 sent on stream 8
âœ… Request 4 sent on stream 12
âœ… Request 5 sent on stream 16
âœ… Created 5 initial request streams
   â””â”€ Stream IDs: [0, 4, 8, 12, 16]
ğŸ“ Sending first GOAWAY frame with ID = 4
ğŸ”’ FIRST GOAWAY: Stream ID 4
âœ… First GOAWAY frame sent with stream ID = 4
   â””â”€ This indicates graceful shutdown starting from stream 4
   â””â”€ Streams 4 and below should not process new requests
ğŸ“ Brief pause to simulate processing...
ğŸ“ Sending second GOAWAY frame with ID = 12
ğŸš« PROTOCOL VIOLATION: Second GOAWAY ID > First GOAWAY ID!
ğŸš« First GOAWAY: 4, Second GOAWAY: 12
ğŸš« Expected error: Connection termination or protocol error
âœ… Second GOAWAY frame sent with stream ID = 12
   â””â”€ This violates HTTP/3 GOAWAY identifier requirements!
   â””â”€ Stream ID 12 > 4 (previous GOAWAY)
   â””â”€ This could confuse clients about which streams to retry
ğŸ“ Sending third GOAWAY frame with even higher ID
ğŸš« ESCALATING VIOLATION: Third GOAWAY ID = 20
ğŸš« Sequence: 4 â†’ 12 â†’ 20
âœ… Third GOAWAY frame sent with stream ID = 20
   â””â”€ This further violates GOAWAY identifier ordering
ğŸ“ Sending fourth GOAWAY frame with correctly decreasing ID
âœ… CONFORMANT GOAWAY: Fourth GOAWAY ID = 0
âœ… This correctly decreases: 20 â†’ 0
âœ… Fourth GOAWAY frame sent with stream ID = 0
   â””â”€ This follows correct GOAWAY identifier ordering
   â””â”€ Shows what conformant behavior should look like
ğŸ“ Attempting to send requests after GOAWAY frames
âœ… Post-GOAWAY request 1 sent on stream 20
âœ… Post-GOAWAY request 2 sent on stream 24
âœ… Post-GOAWAY request 3 sent on stream 28
ğŸ“ Sending fifth GOAWAY frame with extreme ID violation
ğŸš« EXTREME VIOLATION: Fifth GOAWAY ID = 1016
ğŸš« This is much higher than any previous ID
âœ… Extreme GOAWAY frame sent with stream ID = 1016
   â””â”€ This represents a severe GOAWAY ordering violation
ğŸ“ Observing connection behavior after GOAWAY violations
ğŸ“ Sending final request to test connection state
âœ… Final request sent on stream 32
   â””â”€ Connection may still be active despite GOAWAY violations

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #41 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Initial Requests Sent
   âœ… PASS First Goaway Sent
   âœ… PASS Second Goaway Sent
   âœ… PASS Third Goaway Sent
   âœ… PASS Fourth Goaway Sent
   âœ… PASS Post Goaway Request 1 Sent
   âœ… PASS Post Goaway Request 2 Sent
   âœ… PASS Post Goaway Request 3 Sent
   âœ… PASS Extreme Goaway Sent
   âœ… PASS Final Request Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed
   â€¢ Multiple GOAWAY frames sent with increasing identifiers (protocol violation)
   â€¢ GOAWAY sequence: 4 â†’ 12 â†’ 20 â†’ 0 â†’ 1016
   â€¢ Violations: Second, third, and extreme GOAWAY IDs were higher than previous
   â€¢ Conformant: Fourth GOAWAY ID correctly decreased
   â€¢ GOAWAY identifiers MUST NOT increase to avoid client retry confusion
   â€¢ Increasing GOAWAY IDs can cause clients to retry already-processed requests
   â€¢ Test validates server handling of malformed GOAWAY sequences

ğŸ“Š Summary: 14/14 steps passed in 6.03s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #45: test_unknown_stream_type.py
============================================================
Status: PASSED
Execution Time: 5.27s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #45
======================================================================
ğŸ“‹ Test: Unknown unidirectional stream type
ğŸš« Violation: Client opens unknown stream type, server should abort or discard
ğŸ“š RFC Section: HTTP/3 Stream Type Handling
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating unknown unidirectional stream
âœ… Unknown stream type 0xcc created on stream 26
ğŸ“ Sending data on unknown stream
âœ… Data sent on unknown stream: 41 bytes
ğŸ“ Observing server behavior...
ğŸ“ Testing connection state
âœ… Connection still active - normal request sent

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #45 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Unknown Stream Created
   âœ… PASS Data Sent
   âœ… PASS Request Stream Created
   âœ… PASS Connection Still Active

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed
   â€¢ Unknown stream type 0xcc sent
   â€¢ Server should abort reading or discard data
   â€¢ Connection should remain active (not connection error)

ğŸ“Š Summary: 7/7 steps passed in 5.04s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #46: test_second_control_stream.py
============================================================
Status: PASSED
Execution Time: 3.26s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #46
======================================================================
ğŸ“‹ Test: Second control stream
ğŸš« Violation: Opening second control stream triggers H3_STREAM_CREATION_ERROR
ğŸ“š RFC Section: Only one control stream per peer is permitted
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating second control stream
ğŸš« PROTOCOL VIOLATION: Second control stream is not permitted!
ğŸš« Expected error: H3_STREAM_CREATION_ERROR (0x103)
âœ… Second control stream created on stream 26
   â””â”€ First control stream: 14
   â””â”€ Second control stream: 26
   â””â”€ This violates the one control stream per peer rule!
ğŸ“ Sending SETTINGS frame on second control stream
âœ… SETTINGS frame sent on second control stream

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #46 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Second Control Stream Created
   âœ… PASS Second Control Stream Settings Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Second control stream opened (protocol violation)
   â€¢ Only one control stream per peer is permitted
   â€¢ Should trigger H3_STREAM_CREATION_ERROR connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 5/5 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #48: test_client_push_stream.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #48
======================================================================
ğŸ“‹ Test: Client-initiated push stream
ğŸš« Violation: Client opening push stream triggers H3_STREAM_CREATION_ERROR
ğŸ“š RFC Section: Only servers can push
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating client-initiated push stream
ğŸš« PROTOCOL VIOLATION: Only servers can push!
ğŸš« Expected error: H3_STREAM_CREATION_ERROR (0x103)
âœ… Push stream created with ID 26
âœ… Push stream type (0x01) sent on stream 26
âœ… Push ID 0 sent on push stream
   â””â”€ This violates the server-only push rule!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #48 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Push Stream Created
   âœ… PASS Push Stream Type Sent
   âœ… PASS Push Id Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Client-initiated push stream opened (protocol violation)
   â€¢ Only servers are allowed to push
   â€¢ Should trigger H3_STREAM_CREATION_ERROR connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 6/6 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #50: test_data_frame_on_control_stream.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #50
======================================================================
ğŸ“‹ Test: DATA frame on control stream
ğŸš« Violation: DATA frame on control stream triggers H3_FRAME_UNEXPECTED
ğŸ“š RFC Section: DATA frames MUST be associated with HTTP request or response
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Sending DATA frame on control stream
ğŸš« PROTOCOL VIOLATION: DATA frames not allowed on control stream!
ğŸš« Expected error: H3_FRAME_UNEXPECTED (0x105)
âŒ Failed to send DATA frame: DATA frame is not allowed in this state
   â””â”€ This may indicate the violation was caught early

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #50 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Data Frame On Control Stream Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ DATA frame sending failed: DATA frame is not allowed in this state
   â€¢ DATA frame sent on control stream (protocol violation)
   â€¢ DATA frames MUST be associated with HTTP request or response
   â€¢ Should trigger H3_FRAME_UNEXPECTED connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 4/4 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #52: test_headers_frame_on_control_stream.py
============================================================
Status: PASSED
Execution Time: 3.21s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #52
======================================================================
ğŸ“‹ Test: HEADERS frame on control stream
ğŸš« Violation: HEADERS frame on control stream triggers H3_FRAME_UNEXPECTED
ğŸ“š RFC Section: HEADERS frames can only be sent on request streams or push streams
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Sending HEADERS frame on control stream
ğŸš« PROTOCOL VIOLATION: HEADERS frames not allowed on control stream!
ğŸš« Expected error: H3_FRAME_UNEXPECTED (0x105)
âœ… HEADERS frame sent on control stream 14
   â””â”€ Headers: 6 header fields
   â””â”€ This violates HTTP/3 frame usage rules!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #52 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Headers Frame On Control Stream Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ HEADERS frame sent on control stream (protocol violation)
   â€¢ HEADERS frames can only be sent on request streams or push streams
   â€¢ Should trigger H3_FRAME_UNEXPECTED connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 4/4 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #54: test_cancel_push_on_request_stream.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #54
======================================================================
ğŸ“‹ Test: CANCEL_PUSH frame on request stream
ğŸš« Violation: CANCEL_PUSH frame on request stream triggers H3_FRAME_UNEXPECTED
ğŸ“š RFC Section: CANCEL_PUSH frame is sent on the control stream
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending initial HEADERS frame
âœ… Initial HEADERS frame sent on stream 0
ğŸ“ Sending CANCEL_PUSH frame on request stream
ğŸš« PROTOCOL VIOLATION: CANCEL_PUSH frames should only be on control stream!
ğŸš« Expected error: H3_FRAME_UNEXPECTED (0x105)
âœ… CANCEL_PUSH frame sent on request stream 0
   â””â”€ Push ID: 0
   â””â”€ This violates HTTP/3 frame usage rules!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #54 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Initial Headers Sent
   âœ… PASS Cancel Push On Request Stream Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ CANCEL_PUSH frame sent on request stream (protocol violation)
   â€¢ CANCEL_PUSH frames should only be sent on control stream
   â€¢ Should trigger H3_FRAME_UNEXPECTED connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 6/6 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #56: test_cancel_push_invalid_id.py
============================================================
Status: PASSED
Execution Time: 3.21s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #56
======================================================================
ğŸ“‹ Test: CANCEL_PUSH frame with invalid push ID
ğŸš« Violation: CANCEL_PUSH with invalid push ID triggers H3_ID_ERROR
ğŸ“š RFC Section: CANCEL_PUSH must reference valid push ID
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Sending CANCEL_PUSH frame with invalid push ID
ğŸš« PROTOCOL VIOLATION: Push ID exceeds allowed range!
ğŸš« Expected error: H3_ID_ERROR (0x108)
âœ… CANCEL_PUSH frame sent on control stream 14
   â””â”€ Invalid Push ID: 5
   â””â”€ Server has not established MAX_PUSH_ID â‰¥ 5
   â””â”€ This violates push ID range constraints!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #56 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Cancel Push Invalid Id Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ CANCEL_PUSH frame with invalid push ID 5 (protocol violation)
   â€¢ Push ID exceeds currently allowed range
   â€¢ Should trigger H3_ID_ERROR connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 4/4 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #58: test_cancel_push_unannounced_id.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #58
======================================================================
ğŸ“‹ Test: CANCEL_PUSH frame for unannounced push ID
ğŸš« Violation: CANCEL_PUSH for unannounced push ID triggers H3_ID_ERROR
ğŸ“š RFC Section: CANCEL_PUSH must reference push ID announced by PUSH_PROMISE
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Sending MAX_PUSH_ID frame to allow push operations
âœ… MAX_PUSH_ID frame sent with limit 10
ğŸ“ Sending CANCEL_PUSH frame for unannounced push ID
ğŸš« PROTOCOL VIOLATION: Push ID never announced by PUSH_PROMISE!
ğŸš« Expected error: H3_ID_ERROR (0x108)
âœ… CANCEL_PUSH frame sent on control stream 14
   â””â”€ Unannounced Push ID: 3
   â””â”€ Server never sent PUSH_PROMISE for this ID
   â””â”€ This violates push ID announcement requirements!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #58 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Max Push Id Sent
   âœ… PASS Cancel Push Unannounced Id Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ CANCEL_PUSH frame for unannounced push ID 3 (protocol violation)
   â€¢ Push ID was never announced by server via PUSH_PROMISE
   â€¢ Should trigger H3_ID_ERROR connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 5/5 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #60: test_second_settings_frame.py
============================================================
Status: PASSED
Execution Time: 3.24s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #60
======================================================================
ğŸ“‹ Test: Second SETTINGS frame
ğŸš« Violation: Second SETTINGS frame triggers H3_FRAME_UNEXPECTED
ğŸ“š RFC Section: Only one SETTINGS frame allowed per control stream
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Sending second SETTINGS frame on control stream
ğŸš« PROTOCOL VIOLATION: Only one SETTINGS frame allowed!
ğŸš« Expected error: H3_FRAME_UNEXPECTED (0x105)
âœ… Second SETTINGS frame sent on control stream 14
   â””â”€ This violates the one SETTINGS frame per control stream rule!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #60 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Second Settings Frame Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Second SETTINGS frame sent on control stream (protocol violation)
   â€¢ Only one SETTINGS frame is allowed per control stream
   â€¢ Should trigger H3_FRAME_UNEXPECTED connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 4/4 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #62: test_settings_on_push_stream.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #62
======================================================================
ğŸ“‹ Test: SETTINGS frame on push stream
ğŸš« Violation: SETTINGS frame on push stream triggers H3_FRAME_UNEXPECTED
ğŸ“š RFC Section: SETTINGS frames MUST NOT be sent on any stream other than control stream
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating push stream
âœ… Push stream created with ID 26
ğŸ“ Sending SETTINGS frame on push stream
ğŸš« PROTOCOL VIOLATION: SETTINGS frames only allowed on control stream!
ğŸš« Expected error: H3_FRAME_UNEXPECTED (0x105)
âœ… SETTINGS frame sent on push stream 26
   â””â”€ This violates SETTINGS frame placement rules!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #62 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Push Stream Created
   âœ… PASS Settings On Push Stream Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ SETTINGS frame sent on push stream (protocol violation)
   â€¢ SETTINGS frames MUST NOT be sent on any stream other than control stream
   â€¢ Should trigger H3_FRAME_UNEXPECTED connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 5/5 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #63: test_duplicate_settings_identifiers.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #63
======================================================================
ğŸ“‹ Test: Duplicate setting identifiers
ğŸš« Violation: Duplicate setting identifiers trigger H3_SETTINGS_ERROR
ğŸ“š RFC Section: Same setting identifier MUST NOT occur more than once
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Creating control stream
ğŸ“ Sending SETTINGS frame with duplicate identifiers
ğŸš« PROTOCOL VIOLATION: Duplicate setting identifiers!
ğŸš« Expected error: H3_SETTINGS_ERROR (0x109)
âœ… SETTINGS frame with duplicate identifiers sent on stream 14
   â””â”€ QPACK_MAX_TABLE_CAPACITY appears twice with different values
   â””â”€ This violates setting identifier uniqueness!
ğŸ“ Creating QPACK streams

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #63 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Duplicate Settings Sent
   âœ… PASS Qpack Streams Created

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ SETTINGS frame with duplicate setting identifiers (protocol violation)
   â€¢ Same setting identifier MUST NOT occur more than once
   â€¢ Should trigger H3_SETTINGS_ERROR connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 4/4 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #65: test_reserved_settings_identifier.py
============================================================
Status: PASSED
Execution Time: 3.22s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #65
======================================================================
ğŸ“‹ Test: Reserved setting identifier
ğŸš« Violation: Reserved setting identifier triggers H3_SETTINGS_ERROR
ğŸ“š RFC Section: Reserved settings MUST NOT be sent by client
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Creating control stream
ğŸ“ Sending SETTINGS frame with reserved identifier
ğŸš« PROTOCOL VIOLATION: Reserved setting identifier 0x2!
ğŸš« Expected error: H3_SETTINGS_ERROR (0x109)
âœ… SETTINGS frame with reserved identifier sent on stream 14
   â””â”€ Reserved setting ID 0x2 (SETTINGS_ENABLE_PUSH) included
   â””â”€ This violates reserved setting restrictions!
ğŸ“ Creating QPACK streams

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #65 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Reserved Settings Sent
   âœ… PASS Qpack Streams Created

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ SETTINGS frame with reserved setting identifier 0x2 (protocol violation)
   â€¢ Reserved settings MUST NOT be sent by client
   â€¢ Should trigger H3_SETTINGS_ERROR connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 4/4 steps passed in 3.01s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #69: test_client_push_promise.py
============================================================
Status: PASSED
Execution Time: 3.24s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #69
======================================================================
ğŸ“‹ Test: Client sends PUSH_PROMISE frame
ğŸš« Violation: Client PUSH_PROMISE triggers H3_FRAME_UNEXPECTED
ğŸ“š RFC Section: Client MUST NOT send PUSH_PROMISE frame
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending initial HEADERS frame
âœ… Initial HEADERS frame sent on stream 0
ğŸ“ Sending PUSH_PROMISE frame from client
ğŸš« PROTOCOL VIOLATION: Clients MUST NOT send PUSH_PROMISE!
ğŸš« Expected error: H3_FRAME_UNEXPECTED (0x105)
âœ… PUSH_PROMISE frame sent on request stream 0
   â””â”€ Push ID: 0
   â””â”€ This violates client PUSH_PROMISE restrictions!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #69 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Initial Headers Sent
   âœ… PASS Push Promise Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ PUSH_PROMISE frame sent by client (protocol violation)
   â€¢ Client MUST NOT send PUSH_PROMISE frame
   â€¢ Should trigger H3_FRAME_UNEXPECTED connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 6/6 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #71: test_goaway_on_request_stream.py
============================================================
Status: PASSED
Execution Time: 3.28s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #71
======================================================================
ğŸ“‹ Test: GOAWAY frame on request stream
ğŸš« Violation: GOAWAY frame on request stream triggers H3_FRAME_UNEXPECTED
ğŸ“š RFC Section: GOAWAY frame must be on control stream only
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending initial HEADERS frame
âœ… Initial HEADERS frame sent on stream 0
ğŸ“ Sending GOAWAY frame on request stream
ğŸš« PROTOCOL VIOLATION: GOAWAY frames only allowed on control stream!
ğŸš« Expected error: H3_FRAME_UNEXPECTED (0x105)
âœ… GOAWAY frame sent on request stream 0
   â””â”€ Stream/Push ID: 0
   â””â”€ This violates GOAWAY frame placement rules!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #71 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Initial Headers Sent
   âœ… PASS Goaway On Request Stream Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ GOAWAY frame sent on request stream (protocol violation)
   â€¢ GOAWAY frame must be on control stream only
   â€¢ Should trigger H3_FRAME_UNEXPECTED connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 6/6 steps passed in 3.03s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #72: test_max_push_id_on_push_stream.py
============================================================
Status: PASSED
Execution Time: 3.25s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #72
======================================================================
ğŸ“‹ Test: MAX_PUSH_ID frame on push stream
ğŸš« Violation: MAX_PUSH_ID frame on push stream triggers H3_FRAME_UNEXPECTED
ğŸ“š RFC Section: MAX_PUSH_ID frame is always sent on control stream
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating push stream
âœ… Push stream created with ID 26
ğŸ“ Sending MAX_PUSH_ID frame on push stream
ğŸš« PROTOCOL VIOLATION: MAX_PUSH_ID frames only allowed on control stream!
ğŸš« Expected error: H3_FRAME_UNEXPECTED (0x105)
âœ… MAX_PUSH_ID frame sent on push stream 26
   â””â”€ Max Push ID: 5
   â””â”€ This violates MAX_PUSH_ID frame placement rules!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #72 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Push Stream Created
   âœ… PASS Max Push Id On Push Stream Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ MAX_PUSH_ID frame sent on push stream (protocol violation)
   â€¢ MAX_PUSH_ID frame is always sent on control stream
   â€¢ Should trigger H3_FRAME_UNEXPECTED connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 5/5 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #75: test_reserved_frame_type.py
============================================================
Status: PASSED
Execution Time: 3.25s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #75
======================================================================
ğŸ“‹ Test: Reserved frame type
ğŸš« Violation: Reserved frame type triggers H3_FRAME_UNEXPECTED
ğŸ“š RFC Section: Reserved frame types MUST NOT be sent by client
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending initial HEADERS frame
âœ… Initial HEADERS frame sent on stream 0
ğŸ“ Sending reserved frame type on request stream
ğŸš« PROTOCOL VIOLATION: Reserved frame type 0x4!
ğŸš« Expected error: H3_FRAME_UNEXPECTED (0x105)
âœ… Reserved frame type 0x4 sent on request stream 0
   â””â”€ This violates reserved frame type restrictions!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #75 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Initial Headers Sent
   âœ… PASS Reserved Frame Type Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Reserved frame type 0x4 sent on request stream (protocol violation)
   â€¢ Reserved frame types MUST NOT be sent by client
   â€¢ Should trigger H3_FRAME_UNEXPECTED connection error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 6/6 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #77: test_forbidden_header_characters.py
============================================================
Status: PASSED
Execution Time: 3.27s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #77
======================================================================
ğŸ“‹ Test: Forbidden characters in header values
ğŸš« Violation: Forbidden header characters trigger malformed request
ğŸ“š RFC Section: Characters not permitted in field value MUST be treated as malformed
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with forbidden characters
ğŸš« PROTOCOL VIOLATION: Carriage return in header value!
ğŸš« Expected: Malformed request error
âœ… HEADERS frame with forbidden characters sent on stream 0
   â””â”€ Header 'x-custom' contains carriage return (0x0d)
   â””â”€ This violates header value character restrictions!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #77 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Forbidden Header Characters Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Header value with forbidden carriage return character (protocol violation)
   â€¢ Characters not permitted in field value MUST be treated as malformed
   â€¢ Should trigger malformed request error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 5/5 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #78: test_linefeed_header_characters.py
============================================================
Status: PASSED
Execution Time: 3.25s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #78
======================================================================
ğŸ“‹ Test: Line feed characters in header values
ğŸš« Violation: Line feed header characters trigger malformed request
ğŸ“š RFC Section: Characters not permitted in field value MUST be treated as malformed
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with line feed characters
ğŸš« PROTOCOL VIOLATION: Line feed in header value!
ğŸš« Expected: Malformed request error
âœ… HEADERS frame with line feed characters sent on stream 0
   â””â”€ Header 'x-info' contains line feed (0x0a)
   â””â”€ This violates header value character restrictions!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #78 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Linefeed Header Characters Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Header value with forbidden line feed character (protocol violation)
   â€¢ Characters not permitted in field value MUST be treated as malformed
   â€¢ Should trigger malformed request error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 5/5 steps passed in 3.02s
======================================================================

------------------------------------------------------------

============================================================
TEST CASE #79: test_null_header_characters.py
============================================================
Status: PASSED
Execution Time: 3.23s

STDOUT:
------------------------------
======================================================================
ğŸ§ª NON-CONFORMANCE TEST CASE #79
======================================================================
ğŸ“‹ Test: Null characters in header values
ğŸš« Violation: Null header characters trigger malformed request
ğŸ“š RFC Section: Characters not permitted in field value MUST be treated as malformed
ğŸ¯ Target: localhost:4433
======================================================================
ğŸ“ Setting up conformant HTTP/3 connection
âœ… HTTP/3 connection established (control: 14)
ğŸ“ Creating request stream
ğŸ“ Sending HEADERS frame with null characters
ğŸš« PROTOCOL VIOLATION: Null character in header value!
ğŸš« Expected: Malformed request error
âœ… HEADERS frame with null characters sent on stream 0
   â””â”€ Header 'x-user' contains null character (0x00)
   â””â”€ This violates header value character restrictions!

ğŸ“ Observing server behavior (3.0s)

======================================================================
ğŸ“Š TEST CASE #79 RESULTS
======================================================================
ğŸ§ª Test Execution:
   âœ… PASS Connection Established
   âœ… PASS Control Stream Created
   âœ… PASS Qpack Streams Created
   âœ… PASS Request Stream Created
   âœ… PASS Null Header Characters Sent

ğŸ”Œ Connection Terminated: H3_STREAM_CREATION_ERROR
   Reason: Only one QPACK encoder stream is allowed

ğŸ“ Key Observations:
   â€¢ Header value with forbidden null character (protocol violation)
   â€¢ Characters not permitted in field value MUST be treated as malformed
   â€¢ Should trigger malformed request error
   â€¢ Connection terminated: H3_STREAM_CREATION_ERROR - Only one QPACK encoder stream is allowed

ğŸ“Š Summary: 5/5 steps passed in 3.02s
======================================================================

------------------------------------------------------------
